"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const queryMiddleware = require("farce/lib/queryMiddleware");
const createRender = require("found/lib/createRender");
const makeRouteConfig = require("found/lib/makeRouteConfig");
const Route = require("found/lib/Route");
const React = require("react");
const { graphql } = require('react-relay');
const found_relay_1 = require("found-relay");
const relay_runtime_1 = require("relay-runtime");
const Main_1 = require("./components/Main");
const VideoList_1 = require("./components/VideoList");
const SetActiveVideosPage_1 = require("./components/SetActiveVideosPage");
const ErrorPage_1 = require("./components/ErrorPage");
class AppFrame extends React.Component {
    render() {
        return (React.createElement(Main_1.default, null, this.props.children));
    }
}
exports.historyMiddlewares = [queryMiddleware];
function createResolver(fetcher) {
    const environment = new relay_runtime_1.Environment({
        network: relay_runtime_1.Network.create((...args) => fetcher.fetch(...args)),
        store: new relay_runtime_1.Store(new relay_runtime_1.RecordSource()),
    });
    return new found_relay_1.Resolver(environment);
}
exports.createResolver = createResolver;
exports.renderConfig = createRender({
    renderError: ({ error }) => {
        return (React.createElement(AppFrame, null,
            React.createElement(ErrorPage_1.default, { error: error })));
    }
});
const ActiveVideosQuery = graphql `
	query App_ActiveVideos_Query($statsAge: Int!) {
		activeVideos {
			...SetActiveVideosPage_activeVideos
			...VideoList_activeVideos
		}
	}
`;
const aDay = 4 * 24 * 60 * 60;
exports.routeConfig = makeRouteConfig(React.createElement(Route, { path: "/", Component: AppFrame },
    React.createElement(Route, { Component: VideoList_1.default, query: ActiveVideosQuery, prepareVariables: params => (Object.assign({}, params, { statsAge: aDay })) }),
    React.createElement(Route, { path: "videos/forms/set_active", Component: SetActiveVideosPage_1.default, query: ActiveVideosQuery, prepareVariables: params => (Object.assign({}, params, { statsAge: aDay })) })));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL0FwcC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSw2REFBNkQ7QUFDN0QsdURBQXVEO0FBQ3ZELDZEQUE2RDtBQUM3RCx5Q0FBeUM7QUFDekMsK0JBQThCO0FBQzlCLE1BQU0sRUFBRSxPQUFPLEVBQUUsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUE7QUFDMUMsNkNBQXNDO0FBQ3RDLGlEQUF5RTtBQUd6RSw0Q0FBb0M7QUFDcEMsc0RBQThDO0FBQzlDLDBFQUFrRTtBQUNsRSxzREFBOEM7QUFFOUMsY0FBZSxTQUFRLEtBQUssQ0FBQyxTQUFtQztJQUUvRCxNQUFNO1FBQUssTUFBTSxDQUFDLENBQ2pCLG9CQUFDLGNBQUksUUFDSCxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FDZCxDQUNQLENBQUE7SUFBQSxDQUFDO0NBRUY7QUFHWSxRQUFBLGtCQUFrQixHQUFHLENBQUMsZUFBZSxDQUFDLENBQUE7QUFHbkQsd0JBQStCLE9BQU87SUFDckMsTUFBTSxXQUFXLEdBQUcsSUFBSSwyQkFBVyxDQUFDO1FBQ25DLE9BQU8sRUFBRSx1QkFBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsSUFBSSxLQUFLLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUM1RCxLQUFLLEVBQUUsSUFBSSxxQkFBSyxDQUFDLElBQUksNEJBQVksRUFBRSxDQUFDO0tBQ3BDLENBQUMsQ0FBQztJQUVILE1BQU0sQ0FBQyxJQUFJLHNCQUFRLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDbEMsQ0FBQztBQVBELHdDQU9DO0FBR1ksUUFBQSxZQUFZLEdBQUcsWUFBWSxDQUFDO0lBQ3hDLFdBQVcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFO1FBQU8sTUFBTSxDQUFDLENBQ3BDLG9CQUFDLFFBQVE7WUFDUixvQkFBQyxtQkFBUyxJQUFDLEtBQUssRUFBRSxLQUFLLEdBQUcsQ0FDaEIsQ0FDWCxDQUFBO0lBQUMsQ0FBQztDQUNILENBQUMsQ0FBQTtBQUdGLE1BQU0saUJBQWlCLEdBQUcsT0FBTyxDQUFBOzs7Ozs7O0NBT2hDLENBQUE7QUFFRCxNQUFNLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUE7QUFFaEIsUUFBQSxXQUFXLEdBQUcsZUFBZSxDQUN6QyxvQkFBQyxLQUFLLElBQUMsSUFBSSxFQUFDLEdBQUcsRUFBQyxTQUFTLEVBQUUsUUFBUTtJQUNsQyxvQkFBQyxLQUFLLElBQUMsU0FBUyxFQUFFLG1CQUFTLEVBQUUsS0FBSyxFQUFFLGlCQUFpQixFQUM5QyxnQkFBZ0IsRUFBRSxNQUFNLElBQUksbUJBQU0sTUFBTSxJQUFFLFFBQVEsRUFBRSxJQUFJLElBQUcsR0FBSTtJQUN0RSxvQkFBQyxLQUFLLElBQUMsSUFBSSxFQUFDLHlCQUF5QixFQUM5QixTQUFTLEVBQUUsNkJBQW1CLEVBQUUsS0FBSyxFQUFFLGlCQUFpQixFQUN4RCxnQkFBZ0IsRUFBRSxNQUFNLElBQUksbUJBQU0sTUFBTSxJQUFFLFFBQVEsRUFBRSxJQUFJLElBQUcsR0FBSSxDQUMvRCxDQUNSLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCBxdWVyeU1pZGRsZXdhcmUgPSByZXF1aXJlKCdmYXJjZS9saWIvcXVlcnlNaWRkbGV3YXJlJylcbmltcG9ydCBjcmVhdGVSZW5kZXIgPSByZXF1aXJlKCdmb3VuZC9saWIvY3JlYXRlUmVuZGVyJylcbmltcG9ydCBtYWtlUm91dGVDb25maWcgPSByZXF1aXJlKCdmb3VuZC9saWIvbWFrZVJvdXRlQ29uZmlnJylcbmltcG9ydCBSb3V0ZSA9IHJlcXVpcmUoJ2ZvdW5kL2xpYi9Sb3V0ZScpXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCdcbmNvbnN0IHsgZ3JhcGhxbCB9ID0gcmVxdWlyZSgncmVhY3QtcmVsYXknKVxuaW1wb3J0IHsgUmVzb2x2ZXIgfSBmcm9tICdmb3VuZC1yZWxheSdcbmltcG9ydCB7IEVudmlyb25tZW50LCBOZXR3b3JrLCBSZWNvcmRTb3VyY2UsIFN0b3JlIH0gZnJvbSAncmVsYXktcnVudGltZSdcblxuaW1wb3J0IFJvdXRlQ29tcG9uZW50UHJvcHMgZnJvbSAnLi9wcm9wcy9Sb3V0ZUNvbXBvbmVudCdcbmltcG9ydCBNYWluIGZyb20gJy4vY29tcG9uZW50cy9NYWluJ1xuaW1wb3J0IFZpZGVvTGlzdCBmcm9tICcuL2NvbXBvbmVudHMvVmlkZW9MaXN0J1xuaW1wb3J0IFNldEFjdGl2ZVZpZGVvc1BhZ2UgZnJvbSAnLi9jb21wb25lbnRzL1NldEFjdGl2ZVZpZGVvc1BhZ2UnXG5pbXBvcnQgRXJyb3JQYWdlIGZyb20gJy4vY29tcG9uZW50cy9FcnJvclBhZ2UnXG5cbmNsYXNzIEFwcEZyYW1lIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFJvdXRlQ29tcG9uZW50UHJvcHMsIGFueT4ge1xuXG5cdHJlbmRlcigpIHsgcmV0dXJuIChcblx0XHQ8TWFpbj5cblx0XHRcdHt0aGlzLnByb3BzLmNoaWxkcmVufVxuXHRcdDwvTWFpbj5cblx0KX1cblxufVxuXG5cbmV4cG9ydCBjb25zdCBoaXN0b3J5TWlkZGxld2FyZXMgPSBbcXVlcnlNaWRkbGV3YXJlXVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZXNvbHZlcihmZXRjaGVyKSB7XG5cdGNvbnN0IGVudmlyb25tZW50ID0gbmV3IEVudmlyb25tZW50KHtcblx0XHRuZXR3b3JrOiBOZXR3b3JrLmNyZWF0ZSgoLi4uYXJncykgPT4gZmV0Y2hlci5mZXRjaCguLi5hcmdzKSksXG5cdFx0c3RvcmU6IG5ldyBTdG9yZShuZXcgUmVjb3JkU291cmNlKCkpLFxuXHR9KTtcblxuXHRyZXR1cm4gbmV3IFJlc29sdmVyKGVudmlyb25tZW50KTtcbn1cblxuXG5leHBvcnQgY29uc3QgcmVuZGVyQ29uZmlnID0gY3JlYXRlUmVuZGVyKHtcblx0cmVuZGVyRXJyb3I6ICh7IGVycm9yIH0pID0+IHsgcmV0dXJuIChcblx0XHQ8QXBwRnJhbWU+XG5cdFx0XHQ8RXJyb3JQYWdlIGVycm9yPXtlcnJvcn0vPlxuXHRcdDwvQXBwRnJhbWU+XG5cdCkgfVxufSlcblxuXG5jb25zdCBBY3RpdmVWaWRlb3NRdWVyeSA9IGdyYXBocWxgXG5cdHF1ZXJ5IEFwcF9BY3RpdmVWaWRlb3NfUXVlcnkoJHN0YXRzQWdlOiBJbnQhKSB7XG5cdFx0YWN0aXZlVmlkZW9zIHtcblx0XHRcdC4uLlNldEFjdGl2ZVZpZGVvc1BhZ2VfYWN0aXZlVmlkZW9zXG5cdFx0XHQuLi5WaWRlb0xpc3RfYWN0aXZlVmlkZW9zXG5cdFx0fVxuXHR9XG5gXG5cbmNvbnN0IGFEYXkgPSA0ICogMjQgKiA2MCAqIDYwXG5cbmV4cG9ydCBjb25zdCByb3V0ZUNvbmZpZyA9IG1ha2VSb3V0ZUNvbmZpZyhcblx0PFJvdXRlIHBhdGg9XCIvXCIgQ29tcG9uZW50PXtBcHBGcmFtZX0+XG5cdFx0PFJvdXRlIENvbXBvbmVudD17VmlkZW9MaXN0fSBxdWVyeT17QWN0aXZlVmlkZW9zUXVlcnl9XG5cdFx0ICAgICAgIHByZXBhcmVWYXJpYWJsZXM9e3BhcmFtcyA9PiAoeyAuLi5wYXJhbXMsIHN0YXRzQWdlOiBhRGF5IH0pfSAvPlxuXHRcdDxSb3V0ZSBwYXRoPVwidmlkZW9zL2Zvcm1zL3NldF9hY3RpdmVcIlxuXHRcdCAgICAgICBDb21wb25lbnQ9e1NldEFjdGl2ZVZpZGVvc1BhZ2V9IHF1ZXJ5PXtBY3RpdmVWaWRlb3NRdWVyeX1cblx0XHQgICAgICAgcHJlcGFyZVZhcmlhYmxlcz17cGFyYW1zID0+ICh7IC4uLnBhcmFtcywgc3RhdHNBZ2U6IGFEYXkgfSl9IC8+XG5cdDwvUm91dGU+XG4pXG4iXX0=