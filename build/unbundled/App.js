"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const queryMiddleware = require("farce/lib/queryMiddleware");
const createRender = require("found/lib/createRender");
const makeRouteConfig = require("found/lib/makeRouteConfig");
const Route = require("found/lib/Route");
const React = require("react");
const { graphql } = require('react-relay');
const found_relay_1 = require("found-relay");
const relay_runtime_1 = require("relay-runtime");
const Main_1 = require("./components/Main");
const VideoList_1 = require("./components/VideoList");
const SetActiveVideosPage_1 = require("./components/SetActiveVideosPage");
const ErrorPage_1 = require("./components/ErrorPage");
class AppFrame extends React.Component {
    render() {
        return (React.createElement(Main_1.default, null, this.props.children));
    }
}
exports.historyMiddlewares = [queryMiddleware];
function createResolver(fetcher) {
    const environment = new relay_runtime_1.Environment({
        network: relay_runtime_1.Network.create((...args) => fetcher.fetch(...args)),
        store: new relay_runtime_1.Store(new relay_runtime_1.RecordSource()),
    });
    return new found_relay_1.Resolver(environment);
}
exports.createResolver = createResolver;
exports.renderConfig = createRender({
    renderError: ({ error }) => {
        return (React.createElement(AppFrame, null,
            React.createElement(ErrorPage_1.default, { error: error })));
    }
});
const ActiveVideosQuery = graphql `
	query App_ActiveVideos_Query($statsAge: Int!) {
		activeVideos {
			...SetActiveVideosPage_activeVideos
			...VideoList_activeVideos
		}
	}
`;
const aDay = 24 * 60 * 60;
exports.routeConfig = makeRouteConfig(React.createElement(Route, { path: "/", Component: AppFrame },
    React.createElement(Route, { Component: VideoList_1.default, query: ActiveVideosQuery, prepareVariables: params => (Object.assign({}, params, { statsAge: aDay })) }),
    React.createElement(Route, { path: "videos/forms/set_active", Component: SetActiveVideosPage_1.default, query: ActiveVideosQuery, prepareVariables: params => (Object.assign({}, params, { statsAge: aDay })) })));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL0FwcC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSw2REFBNkQ7QUFDN0QsdURBQXVEO0FBQ3ZELDZEQUE2RDtBQUM3RCx5Q0FBeUM7QUFDekMsK0JBQThCO0FBQzlCLE1BQU0sRUFBRSxPQUFPLEVBQUUsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUE7QUFDMUMsNkNBQXNDO0FBQ3RDLGlEQUF5RTtBQUd6RSw0Q0FBb0M7QUFDcEMsc0RBQThDO0FBQzlDLDBFQUFrRTtBQUNsRSxzREFBOEM7QUFHOUMsY0FBZSxTQUFRLEtBQUssQ0FBQyxTQUFtQztJQUUvRCxNQUFNO1FBQUssTUFBTSxDQUFDLENBQ2pCLG9CQUFDLGNBQUksUUFDSCxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FDZCxDQUNQLENBQUE7SUFBQSxDQUFDO0NBRUY7QUFHWSxRQUFBLGtCQUFrQixHQUFHLENBQUMsZUFBZSxDQUFDLENBQUE7QUFHbkQsd0JBQStCLE9BQU87SUFDckMsTUFBTSxXQUFXLEdBQUcsSUFBSSwyQkFBVyxDQUFDO1FBQ25DLE9BQU8sRUFBRSx1QkFBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsSUFBSSxLQUFLLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUM1RCxLQUFLLEVBQUUsSUFBSSxxQkFBSyxDQUFDLElBQUksNEJBQVksRUFBRSxDQUFDO0tBQ3BDLENBQUMsQ0FBQztJQUVILE1BQU0sQ0FBQyxJQUFJLHNCQUFRLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDbEMsQ0FBQztBQVBELHdDQU9DO0FBR1ksUUFBQSxZQUFZLEdBQUcsWUFBWSxDQUFDO0lBQ3hDLFdBQVcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFO1FBQU8sTUFBTSxDQUFDLENBQ3BDLG9CQUFDLFFBQVE7WUFDUixvQkFBQyxtQkFBUyxJQUFDLEtBQUssRUFBRSxLQUFLLEdBQUcsQ0FDaEIsQ0FDWCxDQUFBO0lBQUMsQ0FBQztDQUNILENBQUMsQ0FBQTtBQUdGLE1BQU0saUJBQWlCLEdBQUcsT0FBTyxDQUFBOzs7Ozs7O0NBT2hDLENBQUE7QUFFRCxNQUFNLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQTtBQUVaLFFBQUEsV0FBVyxHQUFHLGVBQWUsQ0FDekMsb0JBQUMsS0FBSyxJQUFDLElBQUksRUFBQyxHQUFHLEVBQUMsU0FBUyxFQUFFLFFBQVE7SUFDbEMsb0JBQUMsS0FBSyxJQUFDLFNBQVMsRUFBRSxtQkFBUyxFQUFFLEtBQUssRUFBRSxpQkFBaUIsRUFDOUMsZ0JBQWdCLEVBQUUsTUFBTSxJQUFJLG1CQUFNLE1BQU0sSUFBRSxRQUFRLEVBQUUsSUFBSSxJQUFHLEdBQUk7SUFDdEUsb0JBQUMsS0FBSyxJQUFDLElBQUksRUFBQyx5QkFBeUIsRUFDOUIsU0FBUyxFQUFFLDZCQUFtQixFQUFFLEtBQUssRUFBRSxpQkFBaUIsRUFDeEQsZ0JBQWdCLEVBQUUsTUFBTSxJQUFJLG1CQUFNLE1BQU0sSUFBRSxRQUFRLEVBQUUsSUFBSSxJQUFHLEdBQUksQ0FDL0QsQ0FDUixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgcXVlcnlNaWRkbGV3YXJlID0gcmVxdWlyZSgnZmFyY2UvbGliL3F1ZXJ5TWlkZGxld2FyZScpXG5pbXBvcnQgY3JlYXRlUmVuZGVyID0gcmVxdWlyZSgnZm91bmQvbGliL2NyZWF0ZVJlbmRlcicpXG5pbXBvcnQgbWFrZVJvdXRlQ29uZmlnID0gcmVxdWlyZSgnZm91bmQvbGliL21ha2VSb3V0ZUNvbmZpZycpXG5pbXBvcnQgUm91dGUgPSByZXF1aXJlKCdmb3VuZC9saWIvUm91dGUnKVxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnXG5jb25zdCB7IGdyYXBocWwgfSA9IHJlcXVpcmUoJ3JlYWN0LXJlbGF5JylcbmltcG9ydCB7IFJlc29sdmVyIH0gZnJvbSAnZm91bmQtcmVsYXknXG5pbXBvcnQgeyBFbnZpcm9ubWVudCwgTmV0d29yaywgUmVjb3JkU291cmNlLCBTdG9yZSB9IGZyb20gJ3JlbGF5LXJ1bnRpbWUnXG5cbmltcG9ydCBSb3V0ZUNvbXBvbmVudFByb3BzIGZyb20gJy4vcHJvcHMvUm91dGVDb21wb25lbnQnXG5pbXBvcnQgTWFpbiBmcm9tICcuL2NvbXBvbmVudHMvTWFpbidcbmltcG9ydCBWaWRlb0xpc3QgZnJvbSAnLi9jb21wb25lbnRzL1ZpZGVvTGlzdCdcbmltcG9ydCBTZXRBY3RpdmVWaWRlb3NQYWdlIGZyb20gJy4vY29tcG9uZW50cy9TZXRBY3RpdmVWaWRlb3NQYWdlJ1xuaW1wb3J0IEVycm9yUGFnZSBmcm9tICcuL2NvbXBvbmVudHMvRXJyb3JQYWdlJ1xuXG5cbmNsYXNzIEFwcEZyYW1lIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFJvdXRlQ29tcG9uZW50UHJvcHMsIGFueT4ge1xuXG5cdHJlbmRlcigpIHsgcmV0dXJuIChcblx0XHQ8TWFpbj5cblx0XHRcdHt0aGlzLnByb3BzLmNoaWxkcmVufVxuXHRcdDwvTWFpbj5cblx0KX1cblxufVxuXG5cbmV4cG9ydCBjb25zdCBoaXN0b3J5TWlkZGxld2FyZXMgPSBbcXVlcnlNaWRkbGV3YXJlXVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZXNvbHZlcihmZXRjaGVyKSB7XG5cdGNvbnN0IGVudmlyb25tZW50ID0gbmV3IEVudmlyb25tZW50KHtcblx0XHRuZXR3b3JrOiBOZXR3b3JrLmNyZWF0ZSgoLi4uYXJncykgPT4gZmV0Y2hlci5mZXRjaCguLi5hcmdzKSksXG5cdFx0c3RvcmU6IG5ldyBTdG9yZShuZXcgUmVjb3JkU291cmNlKCkpLFxuXHR9KTtcblxuXHRyZXR1cm4gbmV3IFJlc29sdmVyKGVudmlyb25tZW50KTtcbn1cblxuXG5leHBvcnQgY29uc3QgcmVuZGVyQ29uZmlnID0gY3JlYXRlUmVuZGVyKHtcblx0cmVuZGVyRXJyb3I6ICh7IGVycm9yIH0pID0+IHsgcmV0dXJuIChcblx0XHQ8QXBwRnJhbWU+XG5cdFx0XHQ8RXJyb3JQYWdlIGVycm9yPXtlcnJvcn0vPlxuXHRcdDwvQXBwRnJhbWU+XG5cdCkgfVxufSlcblxuXG5jb25zdCBBY3RpdmVWaWRlb3NRdWVyeSA9IGdyYXBocWxgXG5cdHF1ZXJ5IEFwcF9BY3RpdmVWaWRlb3NfUXVlcnkoJHN0YXRzQWdlOiBJbnQhKSB7XG5cdFx0YWN0aXZlVmlkZW9zIHtcblx0XHRcdC4uLlNldEFjdGl2ZVZpZGVvc1BhZ2VfYWN0aXZlVmlkZW9zXG5cdFx0XHQuLi5WaWRlb0xpc3RfYWN0aXZlVmlkZW9zXG5cdFx0fVxuXHR9XG5gXG5cbmNvbnN0IGFEYXkgPSAyNCAqIDYwICogNjBcblxuZXhwb3J0IGNvbnN0IHJvdXRlQ29uZmlnID0gbWFrZVJvdXRlQ29uZmlnKFxuXHQ8Um91dGUgcGF0aD1cIi9cIiBDb21wb25lbnQ9e0FwcEZyYW1lfT5cblx0XHQ8Um91dGUgQ29tcG9uZW50PXtWaWRlb0xpc3R9IHF1ZXJ5PXtBY3RpdmVWaWRlb3NRdWVyeX1cblx0XHQgICAgICAgcHJlcGFyZVZhcmlhYmxlcz17cGFyYW1zID0+ICh7IC4uLnBhcmFtcywgc3RhdHNBZ2U6IGFEYXkgfSl9IC8+XG5cdFx0PFJvdXRlIHBhdGg9XCJ2aWRlb3MvZm9ybXMvc2V0X2FjdGl2ZVwiXG5cdFx0ICAgICAgIENvbXBvbmVudD17U2V0QWN0aXZlVmlkZW9zUGFnZX0gcXVlcnk9e0FjdGl2ZVZpZGVvc1F1ZXJ5fVxuXHRcdCAgICAgICBwcmVwYXJlVmFyaWFibGVzPXtwYXJhbXMgPT4gKHsgLi4ucGFyYW1zLCBzdGF0c0FnZTogYURheSB9KX0gLz5cblx0PC9Sb3V0ZT5cbilcbiJdfQ==